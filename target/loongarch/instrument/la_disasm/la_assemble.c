#include <assert.h>
#include <stdio.h>
#include "./include/assemble.h"

lisa_opnd_bit_field disa_bit_field_table[] = {
    {OPD_INVALID, {-1,-1}, {-1,-1}},
    {OPD_CA, {15,17}, {-1,-1}},
    {OPD_CD, {0,2}, {-1,-1}},
    {OPD_CJ, {5,7}, {-1,-1}},
    {OPD_CODE, {0,14}, {-1,-1}}, 
    {OPD_CONDF, {15,19}, {-1,-1}},
    {OPD_CONDH, {10,13}, {-1,-1}},
    {OPD_CONDL, {0,3}, {-1,-1}},
    {OPD_CSR, {10,23}, {-1,-1}},
    {OPD_FA, {15,19}, {-1,-1}},
    {OPD_FCSRH, {5,9}, {-1,-1}},
    {OPD_FCSRL, {0,4}, {-1,-1}},
    {OPD_FD, {0,4}, {-1,-1}},
    {OPD_FJ, {5,9}, {-1,-1}},
    {OPD_FK, {10,14}, {-1,-1}},
    {OPD_HINTL, {0,14}, {-1,-1}},
    {OPD_HINTS, {0,4}, {-1,-1}},
    {OPD_I13, {5,17}, {-1,-1}},
    {OPD_IDXS, {18,18}, {-1,-1}},
    {OPD_IDXM, {18,19}, {-1,-1}},
    {OPD_IDXL, {18,20}, {-1,-1}},
    {OPD_IDXLL, {18,21}, {-1,-1}},
    {OPD_LEVEL, {10,17}, {-1,-1}},
    {OPD_LSBD, {10,15}, {-1,-1}},
    {OPD_LSBW, {10,14}, {-1,-1}},
    {OPD_MODE, {5,9}, {-1,-1}},
    {OPD_MSBD, {16,21}, {-1,-1}},
    {OPD_MSBW, {16,20}, {-1,-1}},
    {OPD_OFFS, {10,25}, {-1,-1}},
    {OPD_OFFL, {10,25}, {0,4}},
    {OPD_OFFLL,{10,25}, {0,9}},
    {OPD_OPCACHE, {0,4}, {-1,-1}},
    {OPD_OPX86, {5,9}, {-1,-1}},
    {OPD_PTR, {5,7}, {-1,-1}},
    {OPD_RD, {0,4}, {-1,-1}},
    {OPD_RJ, {5,9}, {-1,-1}},
    {OPD_RK, {10,14}, {-1,-1}},
    {OPD_SA2, {15,16}, {-1,-1}},
    {OPD_SA3, {15,17}, {-1,-1}},
    {OPD_SD, {0,1}, {-1,-1}},
    {OPD_SEQ, {10,17}, {-1,-1}},
    {OPD_SI10, {10,19}, {-1,-1}},
    {OPD_SI11, {10,20}, {-1,-1}},
    {OPD_SI12, {10,21}, {-1,-1}},
    {OPD_SI14, {10,23}, {-1,-1}},
    {OPD_SI16, {10,25}, {-1,-1}},
    {OPD_SI20, {5,24}, {-1,-1}},
    {OPD_SI5, {10,14}, {-1,-1}},
    {OPD_SI8, {10,17}, {-1,-1}},
    {OPD_SI9, {10,18}, {-1,-1}},
    {OPD_SJ, {5,6}, {-1,-1}},
    {OPD_UI1, {10,10}, {-1,-1}},
    {OPD_UI12, {10,21}, {-1,-1}},
    {OPD_UI2, {10,11}, {-1,-1}},
    {OPD_UI3, {10,12}, {-1,-1}},
    {OPD_UI4, {10,13}, {-1,-1}},
    {OPD_UI5H, {15,19}, {-1,-1}},
    {OPD_UI5L, {10,14}, {-1,-1}},
    {OPD_UI6, {10,15}, {-1,-1}},
    {OPD_UI7, {10,16}, {-1,-1}},
    {OPD_UI8, {10,17}, {-1,-1}},
    {OPD_VA, {15,19}, {-1,-1}},
    {OPD_VD, {0,4}, {-1,-1}},
    {OPD_VJ, {5,9}, {-1,-1}},
    {OPD_VK, {10,14}, {-1,-1}},
    {OPD_XA, {15,19}, {-1,-1}},
    {OPD_XD, {0,4}, {-1,-1}},
    {OPD_XJ, {5,9}, {-1,-1}},
    {OPD_XK, {10,14}, {-1,-1}},
};

lisa_insn_format disa_lisa_format_table[] = {
    {LISA_INVALID, 0x0, {}},
    {LISA_GR2SCR, 0x00000800, {OPD_SD, OPD_RJ}},
    {LISA_SCR2GR, 0x00000C00, {OPD_RD, OPD_SJ}},
    {LISA_CLO_W, 0x00001000, {OPD_RD, OPD_RJ}},
    {LISA_CLZ_W, 0x00001400, {OPD_RD, OPD_RJ}},
    {LISA_CTO_W, 0x00001800, {OPD_RD, OPD_RJ}},
    {LISA_CTZ_W, 0x00001C00, {OPD_RD, OPD_RJ}},
    {LISA_CLO_D, 0x00002000, {OPD_RD, OPD_RJ}},
    {LISA_CLZ_D, 0x00002400, {OPD_RD, OPD_RJ}},
    {LISA_CTO_D, 0x00002800, {OPD_RD, OPD_RJ}},
    {LISA_CTZ_D, 0x00002C00, {OPD_RD, OPD_RJ}},
    {LISA_REVB_2H, 0x00003000, {OPD_RD, OPD_RJ}},
    {LISA_REVB_4H, 0x00003400, {OPD_RD, OPD_RJ}},
    {LISA_REVB_2W, 0x00003800, {OPD_RD, OPD_RJ}},
    {LISA_REVB_D, 0x00003C00, {OPD_RD, OPD_RJ}},
    {LISA_REVH_2W, 0x00004000, {OPD_RD, OPD_RJ}},
    {LISA_REVH_D, 0x00004400, {OPD_RD, OPD_RJ}},
    {LISA_BITREV_4B, 0x00004800, {OPD_RD, OPD_RJ}},
    {LISA_BITREV_8B, 0x00004C00, {OPD_RD, OPD_RJ}},
    {LISA_BITREV_W, 0x00005000, {OPD_RD, OPD_RJ}},
    {LISA_BITREV_D, 0x00005400, {OPD_RD, OPD_RJ}},
    {LISA_EXT_W_H, 0x00005800, {OPD_RD, OPD_RJ}},
    {LISA_EXT_W_B, 0x00005C00, {OPD_RD, OPD_RJ}},
    {LISA_RDTIMEL_W, 0x00006000, {OPD_RD, OPD_RJ}},
    {LISA_RDTIMEH_W, 0x00006400, {OPD_RD, OPD_RJ}},
    {LISA_RDTIME_D, 0x00006800, {OPD_RD, OPD_RJ}},
    {LISA_CPUCFG, 0x00006C00, {OPD_RD, OPD_RJ}},
    {LISA_X86MTTOP, 0x00007000, {OPD_PTR}},
    {LISA_X86MFTOP, 0x00007400, {OPD_RD}},
    {LISA_X86LOOPE, 0x00007800, {OPD_RD, OPD_RJ}},
    {LISA_X86LOOPNE, 0x00007C00, {OPD_RD, OPD_RJ}},
    {LISA_X86INC_B, 0x00008000, {OPD_RJ}},
    {LISA_X86INC_H, 0x00008001, {OPD_RJ}},
    {LISA_X86INC_W, 0x00008002, {OPD_RJ}},
    {LISA_X86INC_D, 0x00008003, {OPD_RJ}},
    {LISA_X86DEC_B, 0x00008004, {OPD_RJ}},
    {LISA_X86DEC_H, 0x00008005, {OPD_RJ}},
    {LISA_X86DEC_W, 0x00008006, {OPD_RJ}},
    {LISA_X86DEC_D, 0x00008007, {OPD_RJ}},
    {LISA_X86SETTM, 0x00008008, {}},
    {LISA_X86CLRTM, 0x00008028, {}},
    {LISA_X86INCTOP, 0x00008009, {}},
    {LISA_X86DECTOP, 0x00008029, {}},
    {LISA_ASRTLE_D, 0x00010000, {OPD_RJ, OPD_RK}},
    {LISA_ASRTGT_D, 0x00018000, {OPD_RJ, OPD_RK}},
    {LISA_ALSL_W, 0x00040000, {OPD_RD, OPD_RJ, OPD_RK, OPD_SA2}},
    {LISA_ALSL_WU, 0x00060000, {OPD_RD, OPD_RJ, OPD_RK, OPD_SA2}},
    {LISA_BYTEPICK_W, 0x00080000, {OPD_RD, OPD_RJ, OPD_RK, OPD_SA2}},
    {LISA_BYTEPICK_D, 0x000C0000, {OPD_RD, OPD_RJ, OPD_RK, OPD_SA3}},
    {LISA_ADD_W, 0x00100000, {OPD_RD, OPD_RJ, OPD_RK}},
    {LISA_ADD_D, 0x00108000, {OPD_RD, OPD_RJ, OPD_RK}},
    {LISA_SUB_W, 0x00110000, {OPD_RD, OPD_RJ, OPD_RK}},
    {LISA_SUB_D, 0x00118000, {OPD_RD, OPD_RJ, OPD_RK}},
    {LISA_SLT, 0x00120000, {OPD_RD, OPD_RJ, OPD_RK}},
    {LISA_SLTU, 0x00128000, {OPD_RD, OPD_RJ, OPD_RK}},
    {LISA_MASKEQZ, 0x00130000, {OPD_RD, OPD_RJ, OPD_RK}},
    {LISA_MASKNEZ, 0x00138000, {OPD_RD, OPD_RJ, OPD_RK}},
    {LISA_NOR, 0x00140000, {OPD_RD, OPD_RJ, OPD_RK}},
    {LISA_AND, 0x00148000, {OPD_RD, OPD_RJ, OPD_RK}},
    {LISA_OR, 0x00150000, {OPD_RD, OPD_RJ, OPD_RK}},
    {LISA_XOR, 0x00158000, {OPD_RD, OPD_RJ, OPD_RK}},
    {LISA_ORN, 0x00160000, {OPD_RD, OPD_RJ, OPD_RK}},
    {LISA_ANDN, 0x00168000, {OPD_RD, OPD_RJ, OPD_RK}},
    {LISA_SLL_W, 0x00170000, {OPD_RD, OPD_RJ, OPD_RK}},
    {LISA_SRL_W, 0x00178000, {OPD_RD, OPD_RJ, OPD_RK}},
    {LISA_SRA_W, 0x00180000, {OPD_RD, OPD_RJ, OPD_RK}},
    {LISA_SLL_D, 0x00188000, {OPD_RD, OPD_RJ, OPD_RK}},
    {LISA_SRL_D, 0x00190000, {OPD_RD, OPD_RJ, OPD_RK}},
    {LISA_SRA_D, 0x00198000, {OPD_RD, OPD_RJ, OPD_RK}},
    {LISA_ROTR_B, 0x001A0000, {OPD_RD, OPD_RJ, OPD_RK}},
    {LISA_ROTR_H, 0x001A8000, {OPD_RD, OPD_RJ, OPD_RK}},
    {LISA_ROTR_W, 0x001B0000, {OPD_RD, OPD_RJ, OPD_RK}},
    {LISA_ROTR_D, 0x001B8000, {OPD_RD, OPD_RJ, OPD_RK}},
    {LISA_MUL_W, 0x001C0000, {OPD_RD, OPD_RJ, OPD_RK}},
    {LISA_MULH_W, 0x001C8000, {OPD_RD, OPD_RJ, OPD_RK}},
    {LISA_MULH_WU, 0x001D0000, {OPD_RD, OPD_RJ, OPD_RK}},
    {LISA_MUL_D, 0x001D8000, {OPD_RD, OPD_RJ, OPD_RK}},
    {LISA_MULH_D, 0x001E0000, {OPD_RD, OPD_RJ, OPD_RK}},
    {LISA_MULH_DU, 0x001E8000, {OPD_RD, OPD_RJ, OPD_RK}},
    {LISA_MULW_D_W, 0x001F0000, {OPD_RD, OPD_RJ, OPD_RK}},
    {LISA_MULW_D_WU, 0x001F8000, {OPD_RD, OPD_RJ, OPD_RK}},
    {LISA_DIV_W, 0x00200000, {OPD_RD, OPD_RJ, OPD_RK}},
    {LISA_MOD_W, 0x00208000, {OPD_RD, OPD_RJ, OPD_RK}},
    {LISA_DIV_WU, 0x00210000, {OPD_RD, OPD_RJ, OPD_RK}},
    {LISA_MOD_WU, 0x00218000, {OPD_RD, OPD_RJ, OPD_RK}},
    {LISA_DIV_D, 0x00220000, {OPD_RD, OPD_RJ, OPD_RK}},
    {LISA_MOD_D, 0x00228000, {OPD_RD, OPD_RJ, OPD_RK}},
    {LISA_DIV_DU, 0x00230000, {OPD_RD, OPD_RJ, OPD_RK}},
    {LISA_MOD_DU, 0x00238000, {OPD_RD, OPD_RJ, OPD_RK}},
    {LISA_CRC_W_B_W, 0x00240000, {OPD_RD, OPD_RJ, OPD_RK}},
    {LISA_CRC_W_H_W, 0x00248000, {OPD_RD, OPD_RJ, OPD_RK}},
    {LISA_CRC_W_W_W, 0x00250000, {OPD_RD, OPD_RJ, OPD_RK}},
    {LISA_CRC_W_D_W, 0x00258000, {OPD_RD, OPD_RJ, OPD_RK}},
    {LISA_CRCC_W_B_W, 0x00260000, {OPD_RD, OPD_RJ, OPD_RK}},
    {LISA_CRCC_W_H_W, 0x00268000, {OPD_RD, OPD_RJ, OPD_RK}},
    {LISA_CRCC_W_W_W, 0x00270000, {OPD_RD, OPD_RJ, OPD_RK}},
    {LISA_CRCC_W_D_W, 0x00278000, {OPD_RD, OPD_RJ, OPD_RK}},
    {LISA_ADDU12I_W, 0x00290000, {OPD_RD, OPD_RJ, OPD_SI5}},
    {LISA_ADDU12I_D, 0x00298000, {OPD_RD, OPD_RJ, OPD_SI5}},
    {LISA_BREAK, 0x002A0000, {OPD_CODE}},
    {LISA_DBGCALL, 0x002A8000, {OPD_CODE}},
    {LISA_SYSCALL, 0x002B0000, {OPD_CODE}},
    {LISA_HYPCALL, 0x002B8000, {OPD_CODE}},
    {LISA_ALSL_D, 0x002C0000, {OPD_RD, OPD_RJ, OPD_RK, OPD_SA2}},
    {LISA_ADC_B, 0x00300000, {OPD_RD, OPD_RJ, OPD_RK}},
    {LISA_ADC_H, 0x00308000, {OPD_RD, OPD_RJ, OPD_RK}},
    {LISA_ADC_W, 0x00310000, {OPD_RD, OPD_RJ, OPD_RK}},
    {LISA_ADC_D, 0x00318000, {OPD_RD, OPD_RJ, OPD_RK}},
    {LISA_SBC_B, 0x00320000, {OPD_RD, OPD_RJ, OPD_RK}},
    {LISA_SBC_H, 0x00328000, {OPD_RD, OPD_RJ, OPD_RK}},
    {LISA_SBC_W, 0x00330000, {OPD_RD, OPD_RJ, OPD_RK}},
    {LISA_SBC_D, 0x00338000, {OPD_RD, OPD_RJ, OPD_RK}},
    {LISA_RCR_B, 0x00340000, {OPD_RD, OPD_RJ, OPD_RK}},
    {LISA_RCR_H, 0x00348000, {OPD_RD, OPD_RJ, OPD_RK}},
    {LISA_RCR_W, 0x00350000, {OPD_RD, OPD_RJ, OPD_RK}},
    {LISA_RCR_D, 0x00358000, {OPD_RD, OPD_RJ, OPD_RK}},
    {LISA_ARMMOVE, 0x00364000, {OPD_RD, OPD_RJ, OPD_CONDH}},
    {LISA_SETX86J, 0x00368000, {OPD_RD, OPD_CONDH}},
    {LISA_SETARMJ, 0x0036C000, {OPD_RD, OPD_CONDH}},
    {LISA_ARMADD_W, 0x00370010, {OPD_RJ, OPD_RK, OPD_CONDL}},
    {LISA_ARMSUB_W, 0x00378010, {OPD_RJ, OPD_RK, OPD_CONDL}},
    {LISA_ARMADC_W, 0x00380010, {OPD_RJ, OPD_RK, OPD_CONDL}},
    {LISA_ARMSBC_W, 0x00388010, {OPD_RJ, OPD_RK, OPD_CONDL}},
    {LISA_ARMAND_W, 0x00390010, {OPD_RJ, OPD_RK, OPD_CONDL}},
    {LISA_ARMOR_W, 0x00398010, {OPD_RJ, OPD_RK, OPD_CONDL}},
    {LISA_ARMXOR_W, 0x003A0010, {OPD_RJ, OPD_RK, OPD_CONDL}},
    {LISA_ARMSLL_W, 0x003A8010, {OPD_RJ, OPD_RK, OPD_CONDL}},
    {LISA_ARMSRL_W, 0x003B0010, {OPD_RJ, OPD_RK, OPD_CONDL}},
    {LISA_ARMSRA_W, 0x003B8010, {OPD_RJ, OPD_RK, OPD_CONDL}},
    {LISA_ARMROTR_W, 0x003C0010, {OPD_RJ, OPD_RK, OPD_CONDL}},
    {LISA_ARMSLLI_W, 0x003C8010, {OPD_RJ, OPD_UI5L, OPD_CONDL}},
    {LISA_ARMSRLI_W, 0x003D0010, {OPD_RJ, OPD_UI5L, OPD_CONDL}},
    {LISA_ARMSRAI_W, 0x003D8010, {OPD_RJ, OPD_UI5L, OPD_CONDL}},
    {LISA_ARMROTRI_W, 0x003E0010, {OPD_RJ, OPD_UI5L, OPD_CONDL}},
    {LISA_X86MUL_B, 0x003E8000, {OPD_RJ, OPD_RK}},
    {LISA_X86MUL_H, 0x003E8001, {OPD_RJ, OPD_RK}},
    {LISA_X86MUL_W, 0x003E8002, {OPD_RJ, OPD_RK}},
    {LISA_X86MUL_D, 0x003E8003, {OPD_RJ, OPD_RK}},
    {LISA_X86MUL_BU, 0x003E8004, {OPD_RJ, OPD_RK}},
    {LISA_X86MUL_HU, 0x003E8005, {OPD_RJ, OPD_RK}},
    {LISA_X86MUL_WU, 0x003E8006, {OPD_RJ, OPD_RK}},
    {LISA_X86MUL_DU, 0x003E8007, {OPD_RJ, OPD_RK}},
    {LISA_X86ADD_WU, 0x003F0000, {OPD_RJ, OPD_RK}},
    {LISA_X86ADD_DU, 0x003F0001, {OPD_RJ, OPD_RK}},
    {LISA_X86SUB_WU, 0x003F0002, {OPD_RJ, OPD_RK}},
    {LISA_X86SUB_DU, 0x003F0003, {OPD_RJ, OPD_RK}},
    {LISA_X86ADD_B, 0x003F0004, {OPD_RJ, OPD_RK}},
    {LISA_X86ADD_H, 0x003F0005, {OPD_RJ, OPD_RK}},
    {LISA_X86ADD_W, 0x003F0006, {OPD_RJ, OPD_RK}},
    {LISA_X86ADD_D, 0x003F0007, {OPD_RJ, OPD_RK}},
    {LISA_X86SUB_B, 0x003F0008, {OPD_RJ, OPD_RK}},
    {LISA_X86SUB_H, 0x003F0009, {OPD_RJ, OPD_RK}},
    {LISA_X86SUB_W, 0x003F000A, {OPD_RJ, OPD_RK}},
    {LISA_X86SUB_D, 0x003F000B, {OPD_RJ, OPD_RK}},
    {LISA_X86ADC_B, 0x003F000C, {OPD_RJ, OPD_RK}},
    {LISA_X86ADC_H, 0x003F000D, {OPD_RJ, OPD_RK}},
    {LISA_X86ADC_W, 0x003F000E, {OPD_RJ, OPD_RK}},
    {LISA_X86ADC_D, 0x003F000F, {OPD_RJ, OPD_RK}},
    {LISA_X86SBC_B, 0x003F0010, {OPD_RJ, OPD_RK}},
    {LISA_X86SBC_H, 0x003F0011, {OPD_RJ, OPD_RK}},
    {LISA_X86SBC_W, 0x003F0012, {OPD_RJ, OPD_RK}},
    {LISA_X86SBC_D, 0x003F0013, {OPD_RJ, OPD_RK}},
    {LISA_X86SLL_B, 0x003F0014, {OPD_RJ, OPD_RK}},
    {LISA_X86SLL_H, 0x003F0015, {OPD_RJ, OPD_RK}},
    {LISA_X86SLL_W, 0x003F0016, {OPD_RJ, OPD_RK}},
    {LISA_X86SLL_D, 0x003F0017, {OPD_RJ, OPD_RK}},
    {LISA_X86SRL_B, 0x003F0018, {OPD_RJ, OPD_RK}},
    {LISA_X86SRL_H, 0x003F0019, {OPD_RJ, OPD_RK}},
    {LISA_X86SRL_W, 0x003F001A, {OPD_RJ, OPD_RK}},
    {LISA_X86SRL_D, 0x003F001B, {OPD_RJ, OPD_RK}},
    {LISA_X86SRA_B, 0x003F001C, {OPD_RJ, OPD_RK}},
    {LISA_X86SRA_H, 0x003F001D, {OPD_RJ, OPD_RK}},
    {LISA_X86SRA_W, 0x003F001E, {OPD_RJ, OPD_RK}},
    {LISA_X86SRA_D, 0x003F001F, {OPD_RJ, OPD_RK}},
    {LISA_X86ROTR_B, 0x003F8000, {OPD_RJ, OPD_RK}},
    {LISA_X86ROTR_H, 0x003F8001, {OPD_RJ, OPD_RK}},
    {LISA_X86ROTR_D, 0x003F8002, {OPD_RJ, OPD_RK}},
    {LISA_X86ROTR_W, 0x003F8003, {OPD_RJ, OPD_RK}},
    {LISA_X86ROTL_B, 0x003F8004, {OPD_RJ, OPD_RK}},
    {LISA_X86ROTL_H, 0x003F8005, {OPD_RJ, OPD_RK}},
    {LISA_X86ROTL_W, 0x003F8006, {OPD_RJ, OPD_RK}},
    {LISA_X86ROTL_D, 0x003F8007, {OPD_RJ, OPD_RK}},
    {LISA_X86RCR_B, 0x003F8008, {OPD_RJ, OPD_RK}},
    {LISA_X86RCR_H, 0x003F8009, {OPD_RJ, OPD_RK}},
    {LISA_X86RCR_W, 0x003F800A, {OPD_RJ, OPD_RK}},
    {LISA_X86RCR_D, 0x003F800B, {OPD_RJ, OPD_RK}},
    {LISA_X86RCL_B, 0x003F800C, {OPD_RJ, OPD_RK}},
    {LISA_X86RCL_H, 0x003F800D, {OPD_RJ, OPD_RK}},
    {LISA_X86RCL_W, 0x003F800E, {OPD_RJ, OPD_RK}},
    {LISA_X86RCL_D, 0x003F800F, {OPD_RJ, OPD_RK}},
    {LISA_X86AND_B, 0x003F8010, {OPD_RJ, OPD_RK}},
    {LISA_X86AND_H, 0x003F8011, {OPD_RJ, OPD_RK}},
    {LISA_X86AND_W, 0x003F8012, {OPD_RJ, OPD_RK}},
    {LISA_X86AND_D, 0x003F8013, {OPD_RJ, OPD_RK}},
    {LISA_X86OR_B, 0x003F8014, {OPD_RJ, OPD_RK}},
    {LISA_X86OR_H, 0x003F8015, {OPD_RJ, OPD_RK}},
    {LISA_X86OR_W, 0x003F8016, {OPD_RJ, OPD_RK}},
    {LISA_X86OR_D, 0x003F8017, {OPD_RJ, OPD_RK}},
    {LISA_X86XOR_B, 0x003F8018, {OPD_RJ, OPD_RK}},
    {LISA_X86XOR_H, 0x003F8019, {OPD_RJ, OPD_RK}},
    {LISA_X86XOR_W, 0x003F801A, {OPD_RJ, OPD_RK}},
    {LISA_X86XOR_D, 0x003F801B, {OPD_RJ, OPD_RK}},
    {LISA_ARMNOT_W, 0x003FC01C, {OPD_RJ, OPD_CONDH}},
    {LISA_ARMMOV_W, 0x003FC01D, {OPD_RJ, OPD_CONDH}},
    {LISA_ARMMOV_D, 0x003FC01E, {OPD_RJ, OPD_CONDH}},
    {LISA_ARMRRX_W, 0x003FC01F, {OPD_RJ, OPD_CONDH}},
    {LISA_SLLI_W, 0x00408000, {OPD_RD, OPD_RJ, OPD_UI5L}},
    {LISA_SLLI_D, 0x00410000, {OPD_RD, OPD_RJ, OPD_UI6}},
    {LISA_SRLI_W, 0x00448000, {OPD_RD, OPD_RJ, OPD_UI5L}},
    {LISA_SRLI_D, 0x00450000, {OPD_RD, OPD_RJ, OPD_UI6}},
    {LISA_SRAI_W, 0x00488000, {OPD_RD, OPD_RJ, OPD_UI5L}},
    {LISA_SRAI_D, 0x00490000, {OPD_RD, OPD_RJ, OPD_UI6}},
    {LISA_ROTRI_B, 0x004C2000, {OPD_RD, OPD_RJ, OPD_UI3}},
    {LISA_ROTRI_H, 0x004C4000, {OPD_RD, OPD_RJ, OPD_UI4}},
    {LISA_ROTRI_W, 0x004C8000, {OPD_RD, OPD_RJ, OPD_UI5L}},
    {LISA_ROTRI_D, 0x004D0000, {OPD_RD, OPD_RJ, OPD_UI6}},
    {LISA_RCRI_B, 0x00502000, {OPD_RD, OPD_RJ, OPD_UI3}},
    {LISA_RCRI_H, 0x00504000, {OPD_RD, OPD_RJ, OPD_UI4}},
    {LISA_RCRI_W, 0x00508000, {OPD_RD, OPD_RJ, OPD_UI5L}},
    {LISA_RCRI_D, 0x00510000, {OPD_RD, OPD_RJ, OPD_UI6}},
    {LISA_X86SLLI_B, 0x00542000, {OPD_RJ, OPD_UI3}},
    {LISA_X86SLLI_H, 0x00544001, {OPD_RJ, OPD_UI4}},
    {LISA_X86SLLI_W, 0x00548002, {OPD_RJ, OPD_UI5L}},
    {LISA_X86SLLI_D, 0x00550003, {OPD_RJ, OPD_UI6}},
    {LISA_X86SRLI_B, 0x00542004, {OPD_RJ, OPD_UI3}},
    {LISA_X86SRLI_H, 0x00544005, {OPD_RJ, OPD_UI4}},
    {LISA_X86SRLI_W, 0x00548006, {OPD_RJ, OPD_UI5L}},
    {LISA_X86SRLI_D, 0x00550007, {OPD_RJ, OPD_UI6}},
    {LISA_X86SRAI_B, 0x00542008, {OPD_RJ, OPD_UI3}},
    {LISA_X86SRAI_H, 0x00544009, {OPD_RJ, OPD_UI4}},
    {LISA_X86SRAI_W, 0x0054800A, {OPD_RJ, OPD_UI5L}},
    {LISA_X86SRAI_D, 0x0055000B, {OPD_RJ, OPD_UI6}},
    {LISA_X86ROTRI_B, 0x0054200C, {OPD_RJ, OPD_UI3}},
    {LISA_X86ROTRI_H, 0x0054400D, {OPD_RJ, OPD_UI4}},
    {LISA_X86ROTRI_W, 0x0054800E, {OPD_RJ, OPD_UI5L}},
    {LISA_X86ROTRI_D, 0x0055000F, {OPD_RJ, OPD_UI6}},
    {LISA_X86RCRI_B, 0x00542010, {OPD_RJ, OPD_UI3}},
    {LISA_X86RCRI_H, 0x00544011, {OPD_RJ, OPD_UI4}},
    {LISA_X86RCRI_W, 0x00548012, {OPD_RJ, OPD_UI5L}},
    {LISA_X86RCRI_D, 0x00550013, {OPD_RJ, OPD_UI6}},
    {LISA_X86ROTLI_B, 0x00542014, {OPD_RJ, OPD_UI3}},
    {LISA_X86ROTLI_H, 0x00544015, {OPD_RJ, OPD_UI4}},
    {LISA_X86ROTLI_W, 0x00548016, {OPD_RJ, OPD_UI5L}},
    {LISA_X86ROTLI_D, 0x00550017, {OPD_RJ, OPD_UI6}},
    {LISA_X86RCLI_B, 0x00542018, {OPD_RJ, OPD_UI3}},
    {LISA_X86RCLI_H, 0x00544019, {OPD_RJ, OPD_UI4}},
    {LISA_X86RCLI_W, 0x0054801A, {OPD_RJ, OPD_UI5L}},
    {LISA_X86RCLI_D, 0x0055001B, {OPD_RJ, OPD_UI6}},
    {LISA_X86SETTAG, 0x00580000, {OPD_RD, OPD_OPX86, OPD_UI8}},
    {LISA_X86MFFLAG, 0x005C0000, {OPD_RD, OPD_UI8}},
    {LISA_X86MTFLAG, 0x005C0020, {OPD_RD, OPD_UI8}},
    {LISA_ARMMFFLAG, 0x005C0040, {OPD_RD, OPD_UI8}},
    {LISA_ARMMTFLAG, 0x005C0060, {OPD_RD, OPD_UI8}},
    {LISA_BSTRINS_W, 0x00600000, {OPD_RD, OPD_RJ, OPD_MSBW, OPD_LSBW}},
    {LISA_BSTRPICK_W, 0x00608000, {OPD_RD, OPD_RJ, OPD_MSBW, OPD_LSBW}},
    {LISA_BSTRINS_D, 0x00800000, {OPD_RD, OPD_RJ, OPD_MSBD, OPD_LSBD}},
    {LISA_BSTRPICK_D, 0x00C00000, {OPD_RD, OPD_RJ, OPD_MSBD, OPD_LSBD}},
    
    /* 12-bit immediate instruction */
    {LISA_SLTI, 0x02000000, {OPD_RD, OPD_RJ, OPD_SI12}},
    {LISA_SLTUI, 0x02400000, {OPD_RD, OPD_RJ, OPD_SI12}},
    {LISA_ADDI_W, 0x02800000, {OPD_RD, OPD_RJ, OPD_SI12}},
    {LISA_ADDI_D, 0x02C00000, {OPD_RD, OPD_RJ, OPD_SI12}},
    {LISA_LU52I_D, 0x03000000, {OPD_RD, OPD_RJ, OPD_SI12}},
    {LISA_ANDI, 0x03400000, {OPD_RD, OPD_RJ, OPD_UI12}},
    {LISA_ORI, 0x03800000, {OPD_RD, OPD_RJ, OPD_UI12}},
    {LISA_XORI,0x03C00000, {OPD_RD, OPD_RJ, OPD_UI12}},

    /* long imm instruction */
    {LISA_ADDU16I_D, 0x10000000, {OPD_RD, OPD_RJ, OPD_SI16}},
    {LISA_LU12I_W, 0x14000000, {OPD_RD, OPD_SI20}},
    {LISA_LU32I_D, 0x16000000, {OPD_RD, OPD_SI20}},
    {LISA_PCADDI, 0x18000000, {OPD_RD, OPD_SI20}},
    {LISA_PCALAU12I, 0x1A000000, {OPD_RD, OPD_SI20}},
    {LISA_PCADDU12I, 0x1C000000, {OPD_RD, OPD_SI20}},
    {LISA_PCADDU18I, 0x1E000000, {OPD_RD, OPD_SI20}},

    /* memory access instruction */
    {LISA_LL_W, 0x20000000, {OPD_RD, OPD_RJ, OPD_SI14}},
    {LISA_SC_W, 0x21000000, {OPD_RD, OPD_RJ, OPD_SI14}},
    {LISA_LL_D, 0x22000000, {OPD_RD, OPD_RJ, OPD_SI14}},
    {LISA_SC_D, 0x23000000, {OPD_RD, OPD_RJ, OPD_SI14}},
    {LISA_LDPTR_W, 0x24000000, {OPD_RD, OPD_RJ, OPD_SI14}},
    {LISA_STPTR_W, 0x25000000, {OPD_RD, OPD_RJ, OPD_SI14}},
    {LISA_LDPTR_D, 0x26000000, {OPD_RD, OPD_RJ, OPD_SI14}},
    {LISA_STPTR_D, 0x27000000, {OPD_RD, OPD_RJ, OPD_SI14}},
    {LISA_LD_B, 0x28000000, {OPD_RD, OPD_RJ, OPD_SI12}},
    {LISA_LD_H, 0x28400000, {OPD_RD, OPD_RJ, OPD_SI12}},
    {LISA_LD_W, 0x28800000, {OPD_RD, OPD_RJ, OPD_SI12}},
    {LISA_LD_D, 0x28C00000, {OPD_RD, OPD_RJ, OPD_SI12}},
    {LISA_ST_B, 0x29000000, {OPD_RD, OPD_RJ, OPD_SI12}},
    {LISA_ST_H, 0x29400000, {OPD_RD, OPD_RJ, OPD_SI12}},
    {LISA_ST_W, 0x29800000, {OPD_RD, OPD_RJ, OPD_SI12}},
    {LISA_ST_D, 0x29C00000, {OPD_RD, OPD_RJ, OPD_SI12}},
    {LISA_LD_BU, 0x2A000000, {OPD_RD, OPD_RJ, OPD_SI12}},
    {LISA_LD_HU, 0x2A400000, {OPD_RD, OPD_RJ, OPD_SI12}},
    {LISA_LD_WU, 0x2A800000, {OPD_RD, OPD_RJ, OPD_SI12}},
    {LISA_PRELD, 0x2AC00000, {OPD_HINTS, OPD_RJ, OPD_SI12}},
    {LISA_FLD_S, 0x2B000000, {OPD_FD, OPD_RJ, OPD_SI12}},
    {LISA_FST_S, 0x2B400000, {OPD_FD, OPD_RJ, OPD_SI12}},
    {LISA_FLD_D, 0x2B800000, {OPD_FD, OPD_RJ, OPD_SI12}},
    {LISA_FST_D, 0x2BC00000, {OPD_FD, OPD_RJ, OPD_SI12}},
    {LISA_VLD, 0x2C000000, {OPD_VD, OPD_RJ, OPD_SI12}},
    {LISA_VST, 0x2C400000, {OPD_VD, OPD_RJ, OPD_SI12}},
    {LISA_XVLD, 0x2C800000, {OPD_XD, OPD_RJ, OPD_SI12}},
    {LISA_XVST, 0x2CC00000, {OPD_XD, OPD_RJ, OPD_SI12}},
    {LISA_LDL_W, 0x2E000000, {OPD_RD, OPD_RJ, OPD_SI12}},
    {LISA_LDR_W, 0x2E400000, {OPD_RD, OPD_RJ, OPD_SI12}},
    {LISA_LDL_D, 0x2E800000, {OPD_RD, OPD_RJ, OPD_SI12}},
    {LISA_LDR_D, 0x2EC00000, {OPD_RD, OPD_RJ, OPD_SI12}},
    {LISA_STL_W, 0x2F000000, {OPD_RD, OPD_RJ, OPD_SI12}},
    {LISA_STR_W, 0x2F400000, {OPD_RD, OPD_RJ, OPD_SI12}},
    {LISA_STL_D, 0x2F800000, {OPD_RD, OPD_RJ, OPD_SI12}},
    {LISA_STR_D, 0x2FC00000, {OPD_RD, OPD_RJ, OPD_SI12}},
    {LISA_VLDREPL_D, 0x30100000, {OPD_VD, OPD_RJ, OPD_SI9}},
    {LISA_VLDREPL_W, 0x30200000, {OPD_VD, OPD_RJ, OPD_SI10}},
    {LISA_VLDREPL_H, 0x30400000, {OPD_VD, OPD_RJ, OPD_SI11}},
    {LISA_VLDREPL_B, 0x30800000, {OPD_VD, OPD_RJ, OPD_SI12}},
    {LISA_VSTELM_D, 0x31100000, {OPD_VD, OPD_RJ, OPD_SI8, OPD_IDXS}},
    {LISA_VSTELM_W, 0x31200000, {OPD_VD, OPD_RJ, OPD_SI8, OPD_IDXM}},
    {LISA_VSTELM_H, 0x31400000, {OPD_VD, OPD_RJ, OPD_SI8, OPD_IDXL}},
    {LISA_VSTELM_B, 0x31800000, {OPD_VD, OPD_RJ, OPD_SI8, OPD_IDXLL}},
    {LISA_XVLDREPL_D, 0x32100000, {OPD_XD, OPD_RJ, OPD_SI9}},
    {LISA_XVLDREPL_W, 0x32200000, {OPD_XD, OPD_RJ, OPD_SI10}},
    {LISA_XVLDREPL_H, 0x32400000, {OPD_XD, OPD_RJ, OPD_SI11}},
    {LISA_XVLDREPL_B, 0x32800000, {OPD_XD, OPD_RJ, OPD_SI12}},
    {LISA_XVSTELM_D, 0x33100000, {OPD_XD, OPD_RJ, OPD_SI8, OPD_IDXS}},
    {LISA_XVSTELM_W, 0x33200000, {OPD_XD, OPD_RJ, OPD_SI8, OPD_IDXM}},
    {LISA_XVSTELM_H, 0x33400000, {OPD_XD, OPD_RJ, OPD_SI8, OPD_IDXL}},
    {LISA_XVSTELM_B, 0x33800000, {OPD_XD, OPD_RJ, OPD_SI8, OPD_IDXLL}},
    {LISA_LDX_B, 0x38000000, {OPD_RD, OPD_RJ, OPD_RK}},
    {LISA_LDX_H, 0x38040000, {OPD_RD, OPD_RJ, OPD_RK}},
    {LISA_LDX_W, 0x38080000, {OPD_RD, OPD_RJ, OPD_RK}},
    {LISA_LDX_D, 0x380C0000, {OPD_RD, OPD_RJ, OPD_RK}},
    {LISA_STX_B, 0x38100000, {OPD_RD, OPD_RJ, OPD_RK}},
    {LISA_STX_H, 0x38140000, {OPD_RD, OPD_RJ, OPD_RK}},
    {LISA_STX_W, 0x38180000, {OPD_RD, OPD_RJ, OPD_RK}},
    {LISA_STX_D, 0x381C0000, {OPD_RD, OPD_RJ, OPD_RK}},
    {LISA_LDX_BU, 0x38200000, {OPD_RD, OPD_RJ, OPD_RK}},
    {LISA_LDX_HU, 0x38240000, {OPD_RD, OPD_RJ, OPD_RK}},
    {LISA_LDX_WU, 0x38280000, {OPD_RD, OPD_RJ, OPD_RK}},
    {LISA_PRELDX, 0x382C0000, {OPD_HINTS, OPD_RJ, OPD_RK}},
    {LISA_FLDX_S, 0x38300000, {OPD_FD, OPD_RJ, OPD_RK}},
    {LISA_FLDX_D, 0x38340000, {OPD_FD, OPD_RJ, OPD_RK}},
    {LISA_FSTX_S, 0x38380000, {OPD_FD, OPD_RJ, OPD_RK}},
    {LISA_FSTX_D, 0x383C0000, {OPD_FD, OPD_RJ, OPD_RK}},
    {LISA_VLDX, 0x38400000, {OPD_VD, OPD_RJ, OPD_RK}},
    {LISA_VSTX, 0x38440000, {OPD_VD, OPD_RJ, OPD_RK}},
    {LISA_XVLDX, 0x38480000, {OPD_XD, OPD_RJ, OPD_RK}},
    {LISA_XVSTX, 0x384C0000, {OPD_XD, OPD_RJ, OPD_RK}},
    {LISA_AMSWAP_W, 0x38600000, {OPD_RD, OPD_RJ, OPD_RK}},
    {LISA_AMSWAP_D, 0x38608000, {OPD_RD, OPD_RJ, OPD_RK}},
    {LISA_AMADD_W, 0x38610000, {OPD_RD, OPD_RJ, OPD_RK}},
    {LISA_AMADD_D, 0x38618000, {OPD_RD, OPD_RJ, OPD_RK}},
    {LISA_AMAND_W, 0x38620000, {OPD_RD, OPD_RJ, OPD_RK}},
    {LISA_AMAND_D, 0x38628000, {OPD_RD, OPD_RJ, OPD_RK}},
    {LISA_AMOR_W, 0x38630000, {OPD_RD, OPD_RJ, OPD_RK}},
    {LISA_AMOR_D, 0x38638000, {OPD_RD, OPD_RJ, OPD_RK}},
    {LISA_AMXOR_W, 0x38640000, {OPD_RD, OPD_RJ, OPD_RK}},
    {LISA_AMXOR_D, 0x38648000, {OPD_RD, OPD_RJ, OPD_RK}},
    {LISA_AMMAX_W, 0x38650000, {OPD_RD, OPD_RJ, OPD_RK}},
    {LISA_AMMAX_D, 0x38658000, {OPD_RD, OPD_RJ, OPD_RK}},
    {LISA_AMMIN_W, 0x38660000, {OPD_RD, OPD_RJ, OPD_RK}},
    {LISA_AMMIN_D, 0x38668000, {OPD_RD, OPD_RJ, OPD_RK}},
    {LISA_AMMAX_WU, 0x38670000, {OPD_RD, OPD_RJ, OPD_RK}},
    {LISA_AMMAX_DU, 0x38678000, {OPD_RD, OPD_RJ, OPD_RK}},
    {LISA_AMMIN_WU, 0x38680000, {OPD_RD, OPD_RJ, OPD_RK}},
    {LISA_AMMIN_DU, 0x38688000, {OPD_RD, OPD_RJ, OPD_RK}},
    {LISA_AMSWAP_DB_W, 0x38690000, {OPD_RD, OPD_RJ, OPD_RK}},
    {LISA_AMSWAP_DB_D, 0x38698000, {OPD_RD, OPD_RJ, OPD_RK}},
    {LISA_AMADD_DB_W, 0x386A0000, {OPD_RD, OPD_RJ, OPD_RK}},
    {LISA_AMADD_DB_D, 0x386A8000, {OPD_RD, OPD_RJ, OPD_RK}},
    {LISA_AMAND_DB_W, 0x386B0000, {OPD_RD, OPD_RJ, OPD_RK}},
    {LISA_AMAND_DB_D, 0x386B8000, {OPD_RD, OPD_RJ, OPD_RK}},
    {LISA_AMOR_DB_W, 0x386C0000, {OPD_RD, OPD_RJ, OPD_RK}},
    {LISA_AMOR_DB_D, 0x386C8000, {OPD_RD, OPD_RJ, OPD_RK}},
    {LISA_AMXOR_DB_W, 0x386D0000, {OPD_RD, OPD_RJ, OPD_RK}},
    {LISA_AMXOR_DB_D, 0x386D8000, {OPD_RD, OPD_RJ, OPD_RK}},
    {LISA_AMMAX_DB_W, 0x386E0000, {OPD_RD, OPD_RJ, OPD_RK}},
    {LISA_AMMAX_DB_D, 0x386E8000, {OPD_RD, OPD_RJ, OPD_RK}},
    {LISA_AMMIN_DB_W, 0x386F0000, {OPD_RD, OPD_RJ, OPD_RK}},
    {LISA_AMMIN_DB_D, 0x386F8000, {OPD_RD, OPD_RJ, OPD_RK}},
    {LISA_AMMAX_DB_WU, 0x38700000, {OPD_RD, OPD_RJ, OPD_RK}},
    {LISA_AMMAX_DB_DU, 0x38708000, {OPD_RD, OPD_RJ, OPD_RK}},
    {LISA_AMMIN_DB_WU, 0x38710000, {OPD_RD, OPD_RJ, OPD_RK}},
    {LISA_AMMIN_DB_DU, 0x38718000, {OPD_RD, OPD_RJ, OPD_RK}},
    {LISA_DBAR, 0x38720000, {OPD_HINTL}},
    {LISA_IBAR, 0x38728000, {OPD_HINTL}},
    {LISA_FLDGT_S, 0x38740000, {OPD_FD, OPD_RJ, OPD_RK}},
    {LISA_FLDGT_D, 0x38748000, {OPD_FD, OPD_RJ, OPD_RK}},
    {LISA_FLDLE_S, 0x38750000, {OPD_FD, OPD_RJ, OPD_RK}},
    {LISA_FLDLE_D, 0x38758000, {OPD_FD, OPD_RJ, OPD_RK}},
    {LISA_FSTGT_S, 0x38760000, {OPD_FD, OPD_RJ, OPD_RK}},
    {LISA_FSTGT_D, 0x38768000, {OPD_FD, OPD_RJ, OPD_RK}},
    {LISA_FSTLE_S, 0x38770000, {OPD_FD, OPD_RJ, OPD_RK}},
    {LISA_FSTLE_D, 0x38778000, {OPD_FD, OPD_RJ, OPD_RK}},
    {LISA_LDGT_B, 0x38780000, {OPD_RD, OPD_RJ, OPD_RK}},
    {LISA_LDGT_H, 0x38788000, {OPD_RD, OPD_RJ, OPD_RK}},
    {LISA_LDGT_W, 0x38790000, {OPD_RD, OPD_RJ, OPD_RK}},
    {LISA_LDGT_D, 0x38798000, {OPD_RD, OPD_RJ, OPD_RK}},
    {LISA_LDLE_B, 0x387A0000, {OPD_RD, OPD_RJ, OPD_RK}},
    {LISA_LDLE_H, 0x387A8000, {OPD_RD, OPD_RJ, OPD_RK}},
    {LISA_LDLE_W, 0x387B0000, {OPD_RD, OPD_RJ, OPD_RK}},
    {LISA_LDLE_D, 0x387B8000, {OPD_RD, OPD_RJ, OPD_RK}},
    {LISA_STGT_B, 0x387C0000, {OPD_RD, OPD_RJ, OPD_RK}},
    {LISA_STGT_H, 0x387C8000, {OPD_RD, OPD_RJ, OPD_RK}},
    {LISA_STGT_W, 0x387D0000, {OPD_RD, OPD_RJ, OPD_RK}},
    {LISA_STGT_D, 0x387D8000, {OPD_RD, OPD_RJ, OPD_RK}},
    {LISA_STLE_B, 0x387E0000, {OPD_RD, OPD_RJ, OPD_RK}},
    {LISA_STLE_H, 0x387E8000, {OPD_RD, OPD_RJ, OPD_RK}},
    {LISA_STLE_W, 0x387F0000, {OPD_RD, OPD_RJ, OPD_RK}},
    {LISA_STLE_D, 0x387F8000, {OPD_RD, OPD_RJ, OPD_RK}},

    /* transfer instructions */
    {LISA_BEQZ, 0x40000000, {OPD_RJ, OPD_OFFL}},
    {LISA_BNEZ, 0x44000000, {OPD_RJ, OPD_OFFL}},
    {LISA_BCEQZ, 0x48000000, {OPD_CJ, OPD_OFFL}},
    {LISA_BCNEZ, 0x48000100, {OPD_CJ, OPD_OFFL}},
    {LISA_JISCR0, 0x48000200, {OPD_OFFL}},
    {LISA_JISCR1, 0x48000300, {OPD_OFFL}},
    {LISA_JIRL, 0x4C000000, {OPD_RD, OPD_RJ, OPD_OFFS}},
    {LISA_B, 0x50000000, {OPD_OFFLL}},
    {LISA_BL, 0x54000000, {OPD_OFFLL}},
    {LISA_BEQ, 0x58000000, {OPD_RJ, OPD_RD, OPD_OFFS}},
    {LISA_BNE, 0x5C000000, {OPD_RJ, OPD_RD, OPD_OFFS}},
    {LISA_BLT, 0x60000000, {OPD_RJ, OPD_RD, OPD_OFFS}},
    {LISA_BGE, 0x64000000, {OPD_RJ, OPD_RD, OPD_OFFS}},
    {LISA_BLTU, 0x68000000, {OPD_RJ, OPD_RD, OPD_OFFS}},
    {LISA_BGEU, 0x6C000000, {OPD_RJ, OPD_RD, OPD_OFFS}},

    /* float instructions */
    {LISA_FADD_S, 0x01008000, {OPD_FD, OPD_FJ, OPD_FK}},
    {LISA_FADD_D, 0x01010000, {OPD_FD, OPD_FJ, OPD_FK}},
    {LISA_FSUB_S, 0x01028000, {OPD_FD, OPD_FJ, OPD_FK}},
    {LISA_FSUB_D, 0x01030000, {OPD_FD, OPD_FJ, OPD_FK}},
    {LISA_FMUL_S, 0x01048000, {OPD_FD, OPD_FJ, OPD_FK}},
    {LISA_FMUL_D, 0x01050000, {OPD_FD, OPD_FJ, OPD_FK}},
    {LISA_FDIV_S, 0x01068000, {OPD_FD, OPD_FJ, OPD_FK}},
    {LISA_FDIV_D, 0x01070000, {OPD_FD, OPD_FJ, OPD_FK}},
    {LISA_FMAX_S, 0x01088000, {OPD_FD, OPD_FJ, OPD_FK}},
    {LISA_FMAX_D, 0x01090000, {OPD_FD, OPD_FJ, OPD_FK}},
    {LISA_FMIN_S, 0x010A8000, {OPD_FD, OPD_FJ, OPD_FK}},
    {LISA_FMIN_D, 0x010B0000, {OPD_FD, OPD_FJ, OPD_FK}},
    {LISA_FMAXA_S, 0x010C8000, {OPD_FD, OPD_FJ, OPD_FK}},
    {LISA_FMAXA_D, 0x010D0000, {OPD_FD, OPD_FJ, OPD_FK}},
    {LISA_FMINA_S, 0x010E8000, {OPD_FD, OPD_FJ, OPD_FK}},
    {LISA_FMINA_D, 0x010F0000, {OPD_FD, OPD_FJ, OPD_FK}},
    {LISA_FSCALEB_S, 0x01108000, {OPD_FD, OPD_FJ, OPD_FK}},
    {LISA_FSCALEB_D, 0x01110000, {OPD_FD, OPD_FJ, OPD_FK}},
    {LISA_FCOPYSIGN_S, 0x01128000, {OPD_FD, OPD_FJ, OPD_FK}},
    {LISA_FCOPYSIGN_D, 0x01130000, {OPD_FD, OPD_FJ, OPD_FK}},
    {LISA_FABS_S, 0x01140400, {OPD_FD, OPD_FJ}},
    {LISA_FABS_D, 0x01140800, {OPD_FD, OPD_FJ}},
    {LISA_FNEG_S, 0x01141400, {OPD_FD, OPD_FJ}},
    {LISA_FNEG_D, 0x01141800, {OPD_FD, OPD_FJ}},
    {LISA_FLOGB_S, 0x01142400, {OPD_FD, OPD_FJ}},
    {LISA_FLOGB_D, 0x01142800, {OPD_FD, OPD_FJ}},
    {LISA_FCLASS_S, 0x01143400, {OPD_FD, OPD_FJ}},
    {LISA_FCLASS_D, 0x01143800, {OPD_FD, OPD_FJ}},
    {LISA_FSQRT_S, 0x01144400, {OPD_FD, OPD_FJ}},
    {LISA_FSQRT_D, 0x01144800, {OPD_FD, OPD_FJ}},
    {LISA_FRECIP_S, 0x01145400, {OPD_FD, OPD_FJ}},
    {LISA_FRECIP_D, 0x01145800, {OPD_FD, OPD_FJ}},
    {LISA_FRSQRT_S, 0x01146400, {OPD_FD, OPD_FJ}},
    {LISA_FRSQRT_D, 0x01146800, {OPD_FD, OPD_FJ}},
    {LISA_FMOV_S, 0x01149400, {OPD_FD, OPD_FJ}},
    {LISA_FMOV_D, 0x01149800, {OPD_FD, OPD_FJ}},
    {LISA_MOVGR2FR_W, 0x0114A400, {OPD_FD, OPD_RJ}},
    {LISA_MOVGR2FR_D, 0x0114A800, {OPD_FD, OPD_RJ}},
    {LISA_MOVGR2FRH_W, 0x0114AC00, {OPD_FD, OPD_RJ}},
    {LISA_MOVFR2GR_S, 0x0114B400, {OPD_RD, OPD_FJ}},
    {LISA_MOVFR2GR_D, 0x0114B800, {OPD_RD, OPD_FJ}},
    {LISA_MOVFRH2GR_S, 0x0114BC00, {OPD_RD, OPD_FJ}},
    {LISA_MOVGR2FCSR, 0x0114C000, {OPD_FCSRL, OPD_RJ}},
    {LISA_MOVFCSR2GR, 0x0114C800, {OPD_RD, OPD_FCSRH}},
    {LISA_MOVFR2CF, 0x0114D000, {OPD_CD, OPD_FJ}},
    {LISA_MOVCF2FR, 0x0114D400, {OPD_FD, OPD_CJ}},
    {LISA_MOVGR2CF, 0x0114D800, {OPD_CD, OPD_RJ}},
    {LISA_MOVCF2GR, 0x0114DC00, {OPD_RD, OPD_CJ}},
    {LISA_FCVT_LD_D, 0x0114E000, {OPD_FD, OPD_FJ}},
    {LISA_FCVT_UD_D, 0x0114E400, {OPD_FD, OPD_FJ}},
    {LISA_FCVT_D_LD, 0x01150000, {OPD_FD, OPD_FJ, OPD_FK}},
    {LISA_FCVT_S_D, 0x01191800, {OPD_FD, OPD_FJ}},
    {LISA_FCVT_D_S, 0x01192400, {OPD_FD, OPD_FJ}},
    {LISA_FTINTRM_W_S, 0x011A0400, {OPD_FD, OPD_FJ}},
    {LISA_FTINTRM_W_D, 0x011A0800, {OPD_FD, OPD_FJ}},
    {LISA_FTINTRM_L_S, 0x011A2400, {OPD_FD, OPD_FJ}},
    {LISA_FTINTRM_L_D, 0x011A2800, {OPD_FD, OPD_FJ}},
    {LISA_FTINTRP_W_S, 0x011A4400, {OPD_FD, OPD_FJ}},
    {LISA_FTINTRP_W_D, 0x011A4800, {OPD_FD, OPD_FJ}},
    {LISA_FTINTRP_L_S, 0x011A6400, {OPD_FD, OPD_FJ}},
    {LISA_FTINTRP_L_D, 0x011A6800, {OPD_FD, OPD_FJ}},
    {LISA_FTINTRZ_W_S, 0x011A8400, {OPD_FD, OPD_FJ}},
    {LISA_FTINTRZ_W_D, 0x011A8800, {OPD_FD, OPD_FJ}},
    {LISA_FTINTRZ_L_S, 0x011AA400, {OPD_FD, OPD_FJ}},
    {LISA_FTINTRZ_L_D, 0x011AA800, {OPD_FD, OPD_FJ}},
    {LISA_FTINTRNE_W_S, 0x011AC400, {OPD_FD, OPD_FJ}},
    {LISA_FTINTRNE_W_D, 0x011AC800, {OPD_FD, OPD_FJ}},
    {LISA_FTINTRNE_L_S, 0x011AE400, {OPD_FD, OPD_FJ}},
    {LISA_FTINTRNE_L_D, 0x011AE800, {OPD_FD, OPD_FJ}},
    {LISA_FTINT_W_S, 0x011B0400, {OPD_FD, OPD_FJ}},
    {LISA_FTINT_W_D, 0x011B0800, {OPD_FD, OPD_FJ}},
    {LISA_FTINT_L_S, 0x011B2400, {OPD_FD, OPD_FJ}},
    {LISA_FTINT_L_D, 0x011B2800, {OPD_FD, OPD_FJ}},
    {LISA_FFINT_S_W, 0x011D1000, {OPD_FD, OPD_FJ}},
    {LISA_FFINT_S_L, 0x011D1800, {OPD_FD, OPD_FJ}},
    {LISA_FFINT_D_W, 0x011D2000, {OPD_FD, OPD_FJ}},
    {LISA_FFINT_D_L, 0x011D2800, {OPD_FD, OPD_FJ}},
    {LISA_FRINT_S, 0x011E4400, {OPD_FD, OPD_FJ}},
    {LISA_FRINT_D, 0x011E4800, {OPD_FD, OPD_FJ}},

    /* 4 operands instructions */
    {LISA_FMADD_S, 0x08100000, {OPD_FD, OPD_FJ, OPD_FK, OPD_FA}},
    {LISA_FMADD_D, 0x08200000, {OPD_FD, OPD_FJ, OPD_FK, OPD_FA}},
    {LISA_FMSUB_S, 0x08500000, {OPD_FD, OPD_FJ, OPD_FK, OPD_FA}},
    {LISA_FMSUB_D, 0x08600000, {OPD_FD, OPD_FJ, OPD_FK, OPD_FA}},
    {LISA_FNMADD_S, 0x08900000, {OPD_FD, OPD_FJ, OPD_FK, OPD_FA}},
    {LISA_FNMADD_D, 0x08A00000, {OPD_FD, OPD_FJ, OPD_FK, OPD_FA}},
    {LISA_FNMSUB_S, 0x08D00000, {OPD_FD, OPD_FJ, OPD_FK, OPD_FA}},
    {LISA_FNMSUB_D, 0x08E00000, {OPD_FD, OPD_FJ, OPD_FK, OPD_FA}},
    {LISA_VFMADD_S, 0x09100000, {OPD_VD, OPD_VJ, OPD_VK, OPD_VA}},
    {LISA_VFMADD_D, 0x09200000, {OPD_VD, OPD_VJ, OPD_VK, OPD_VA}},
    {LISA_VFMSUB_S, 0x09500000, {OPD_VD, OPD_VJ, OPD_VK, OPD_VA}},
    {LISA_VFMSUB_D, 0x09600000, {OPD_VD, OPD_VJ, OPD_VK, OPD_VA}},
    {LISA_VFNMADD_S, 0x09900000, {OPD_VD, OPD_VJ, OPD_VK, OPD_VA}},
    {LISA_VFNMADD_D, 0x09A00000, {OPD_VD, OPD_VJ, OPD_VK, OPD_VA}},
    {LISA_VFNMSUB_S, 0x09D00000, {OPD_VD, OPD_VJ, OPD_VK, OPD_VA}},
    {LISA_VFNMSUB_D, 0x09E00000, {OPD_VD, OPD_VJ, OPD_VK, OPD_VA}},
    {LISA_XVFMADD_S, 0x0A100000, {OPD_XD, OPD_XJ, OPD_XK, OPD_XA}},
    {LISA_XVFMADD_D, 0x0A200000, {OPD_XD, OPD_XJ, OPD_XK, OPD_XA}},
    {LISA_XVFMSUB_S, 0x0A500000, {OPD_XD, OPD_XJ, OPD_XK, OPD_XA}},
    {LISA_XVFMSUB_D, 0x0A600000, {OPD_XD, OPD_XJ, OPD_XK, OPD_XA}},
    {LISA_XVFNMADD_S, 0x0A900000, {OPD_XD, OPD_XJ, OPD_XK, OPD_XA}},
    {LISA_XVFNMADD_D, 0x0AA00000, {OPD_XD, OPD_XJ, OPD_XK, OPD_XA}},
    {LISA_XVFNMSUB_S, 0x0AD00000, {OPD_XD, OPD_XJ, OPD_XK, OPD_XA}},
    {LISA_XVFNMSUB_D, 0x0AE00000, {OPD_XD, OPD_XJ, OPD_XK, OPD_XA}},
    {LISA_FCMP_CAF_S, 0x0C100000, {OPD_CD, OPD_FJ, OPD_FK}},
    {LISA_FCMP_SAF_S, 0x0C108000, {OPD_CD, OPD_FJ, OPD_FK}},
    {LISA_FCMP_CLT_S, 0x0C110000, {OPD_CD, OPD_FJ, OPD_FK}},
    {LISA_FCMP_SLT_S, 0x0C118000, {OPD_CD, OPD_FJ, OPD_FK}},
    {LISA_FCMP_CEQ_S, 0x0C120000, {OPD_CD, OPD_FJ, OPD_FK}},
    {LISA_FCMP_SEQ_S, 0x0C128000, {OPD_CD, OPD_FJ, OPD_FK}},
    {LISA_FCMP_CLE_S, 0x0C130000, {OPD_CD, OPD_FJ, OPD_FK}},
    {LISA_FCMP_SLE_S, 0x0C138000, {OPD_CD, OPD_FJ, OPD_FK}},
    {LISA_FCMP_CUN_S, 0x0C140000, {OPD_CD, OPD_FJ, OPD_FK}},
    {LISA_FCMP_SUN_S, 0x0C148000, {OPD_CD, OPD_FJ, OPD_FK}},
    {LISA_FCMP_CULT_S, 0x0C150000, {OPD_CD, OPD_FJ, OPD_FK}},
    {LISA_FCMP_SULT_S, 0x0C158000, {OPD_CD, OPD_FJ, OPD_FK}},
    {LISA_FCMP_CUEQ_S, 0x0C160000, {OPD_CD, OPD_FJ, OPD_FK}},
    {LISA_FCMP_SUEQ_S, 0x0C168000, {OPD_CD, OPD_FJ, OPD_FK}},
    {LISA_FCMP_CULE_S, 0x0C170000, {OPD_CD, OPD_FJ, OPD_FK}},
    {LISA_FCMP_SULE_S, 0x0C178000, {OPD_CD, OPD_FJ, OPD_FK}},
    {LISA_FCMP_CNE_S, 0x0C180000, {OPD_CD, OPD_FJ, OPD_FK}},
    {LISA_FCMP_SNE_S, 0x0C188000, {OPD_CD, OPD_FJ, OPD_FK}},
    {LISA_FCMP_COR_S, 0x0C1A0000, {OPD_CD, OPD_FJ, OPD_FK}},
    {LISA_FCMP_SOR_S, 0x0C1A8000, {OPD_CD, OPD_FJ, OPD_FK}},
    {LISA_FCMP_CUNE_S, 0x0C1C0000, {OPD_CD, OPD_FJ, OPD_FK}},
    {LISA_FCMP_SUNE_S, 0x0C1C8000, {OPD_CD, OPD_FJ, OPD_FK}},
    {LISA_FCMP_CAF_D, 0x0C200000, {OPD_CD, OPD_FJ, OPD_FK}},
    {LISA_FCMP_SAF_D, 0x0C208000, {OPD_CD, OPD_FJ, OPD_FK}},
    {LISA_FCMP_CLT_D, 0x0C210000, {OPD_CD, OPD_FJ, OPD_FK}},
    {LISA_FCMP_SLT_D, 0x0C218000, {OPD_CD, OPD_FJ, OPD_FK}},
    {LISA_FCMP_CEQ_D, 0x0C220000, {OPD_CD, OPD_FJ, OPD_FK}},
    {LISA_FCMP_SEQ_D, 0x0C228000, {OPD_CD, OPD_FJ, OPD_FK}},
    {LISA_FCMP_CLE_D, 0x0C230000, {OPD_CD, OPD_FJ, OPD_FK}},
    {LISA_FCMP_SLE_D, 0x0C238000, {OPD_CD, OPD_FJ, OPD_FK}},
    {LISA_FCMP_CUN_D, 0x0C240000, {OPD_CD, OPD_FJ, OPD_FK}},
    {LISA_FCMP_SUN_D, 0x0C248000, {OPD_CD, OPD_FJ, OPD_FK}},
    {LISA_FCMP_CULT_D, 0x0C250000, {OPD_CD, OPD_FJ, OPD_FK}},
    {LISA_FCMP_SULT_D, 0x0C258000, {OPD_CD, OPD_FJ, OPD_FK}},
    {LISA_FCMP_CUEQ_D, 0x0C260000, {OPD_CD, OPD_FJ, OPD_FK}},
    {LISA_FCMP_SUEQ_D, 0x0C268000, {OPD_CD, OPD_FJ, OPD_FK}},
    {LISA_FCMP_CULE_D, 0x0C270000, {OPD_CD, OPD_FJ, OPD_FK}},
    {LISA_FCMP_SULE_D, 0x0C278000, {OPD_CD, OPD_FJ, OPD_FK}},
    {LISA_FCMP_CNE_D, 0x0C280000, {OPD_CD, OPD_FJ, OPD_FK}},
    {LISA_FCMP_SNE_D, 0x0C288000, {OPD_CD, OPD_FJ, OPD_FK}},
    {LISA_FCMP_COR_D, 0x0C2A0000, {OPD_CD, OPD_FJ, OPD_FK}},
    {LISA_FCMP_SOR_D, 0x0C2A8000, {OPD_CD, OPD_FJ, OPD_FK}},
    {LISA_FCMP_CUNE_D, 0x0C2C0000, {OPD_CD, OPD_FJ, OPD_FK}},
    {LISA_FCMP_SUNE_D, 0x0C2C8000, {OPD_CD, OPD_FJ, OPD_FK}},
    {LISA_VFCMP_COND_S, 0x0C500000, {OPD_VD, OPD_VJ, OPD_VK}},
    {LISA_VFCMP_COND_D, 0x0C600000, {OPD_VD, OPD_VJ, OPD_VK}},
    {LISA_XVFCMP_COND_S, 0x0C900000, {OPD_XD, OPD_XJ, OPD_XK}},
    {LISA_XVFCMP_COND_D, 0x0CA00000, {OPD_XD, OPD_XJ, OPD_XK}},
    {LISA_FSEL, 0x0D000000, {OPD_FD, OPD_FJ, OPD_FK, OPD_CA}},
    {LISA_VBITSEL_V, 0x0D100000, {OPD_VD, OPD_VJ, OPD_VK, OPD_VA}},
    {LISA_XVBITSEL_V, 0x0D200000, {OPD_XD, OPD_XJ, OPD_XK, OPD_XA}},
    {LISA_VSHUF_B, 0x0D500000, {OPD_VD, OPD_VJ, OPD_VK, OPD_VA}},
    {LISA_XVSHUF_B, 0x0D600000, {OPD_XD, OPD_XJ, OPD_XK, OPD_XA}},
    {LISA_VEXTR_V, 0x0D900000, {OPD_VD, OPD_VJ, OPD_VK, OPD_UI5H}},
    {LISA_XVEXTR_V, 0x0DA00000, {OPD_XD, OPD_XJ, OPD_XK, OPD_UI5H}},
    {LISA_VFMADDSUB_S, 0x0E900000, {OPD_VD, OPD_VJ, OPD_VK, OPD_VA}},
    {LISA_VFMADDSUB_D, 0x0EA00000, {OPD_VD, OPD_VJ, OPD_VK, OPD_VA}},
    {LISA_VFMSUBADD_S, 0x0ED00000, {OPD_VD, OPD_VJ, OPD_VK, OPD_VA}},
    {LISA_VFMSUBADD_D, 0x0EE00000, {OPD_VD, OPD_VJ, OPD_VK, OPD_VA}},
    {LISA_XVFMADDSUB_S, 0x0F100000, {OPD_XD, OPD_XJ, OPD_XK, OPD_XA}},
    {LISA_XVFMADDSUB_D, 0x0F200000, {OPD_XD, OPD_XJ, OPD_XK, OPD_XA}},
    {LISA_XVFMSUBADD_S, 0x0F500000, {OPD_XD, OPD_XJ, OPD_XK, OPD_XA}},
    {LISA_XVFMSUBADD_D, 0x0F600000, {OPD_XD, OPD_XJ, OPD_XK, OPD_XA}},

    {LISA_ENDING, 0x0, {}},
};

uint32_t la_assemble(IR2 *pir2)
{
    lisa_insn_format *format = &disa_lisa_format_table[pir2->op];
    assert(format->op == pir2->op);

    uint32_t insn = format->opcode;

    for (int i = 0; i < pir2->opnd_count; ++i) {
        LISA_OPND_TYPE la_opnd_type = format->opnd[i];
        assert(la_opnd_type != OPD_INVALID);

        int val = pir2->opnd[i].val;

        lisa_opnd_bit_field *bit_field = &disa_bit_field_table[la_opnd_type];
        int start = bit_field->bit_range_0.start;
        int end = bit_field->bit_range_0.end;
        int bit_len = end - start + 1;

        int mask = (1 << bit_len) - 1;
        insn |= (val & mask) << start;

        /* OPD_OFFL & OPD_OFFLL */
        start = bit_field->bit_range_1.start;
        end = bit_field->bit_range_1.end;
        if (start >= 0 && end >= 0) {
            val = val >> bit_len;
            bit_len = end - start + 1;
            mask = (1 << bit_len) - 1;
            insn |= (val & mask) << start;
        }
    }
    return insn;
}
